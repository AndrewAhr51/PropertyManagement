<header class="page-header">
  <div class="header-content">
    <h1>üí≥ Tenant Invoices & Payments</h1>
    <p class="subtitle">
      Manage outstanding invoices, view payment status, and initiate secure Stripe checkout sessions.
    </p>
  </div>
</header>

<!-- üìã Invoice List -->
<div class="invoice-list-wrapper">
  <!-- üîç Search Box -->
  <div class="search-bar">
    <label for="searchInput">Search:</label>
    <input
      type="text"
      [(ngModel)]="searchQuery"
      (input)="applyFiltersAndSort()"
      placeholder="Search invoices..."
    />
  </div>

  <!-- üîé Filter Controls -->
  <div class="filter-bar">
    <label>Filter:</label>
    <select [(ngModel)]="filterStatus" (ngModelChange)="setFilter($event)">
      <option value="All">All</option>
      <option value="Paid">Paid</option>
      <option value="Unpaid">Unpaid</option>
    </select>  </div>

  <table class="invoice-table">
 <thead>
  <tr>
    <th (click)="toggleSort('isPaid')" class="sortable">
      Paid
      <span *ngIf="sortKey === 'isPaid'">{{ sortAsc ? '‚ñ≤' : '‚ñº' }}</span>
    </th>
    <th (click)="toggleSort('invoiceId')" class="sortable">
      Invoice #
      <span *ngIf="sortKey === 'invoiceId'">{{ sortAsc ? '‚ñ≤' : '‚ñº' }}</span>
    </th>
    <th (click)="toggleSort('propertyName')" class="sortable" style="width: 20%">
      Property
      <span *ngIf="sortKey === 'propertyName'">{{ sortAsc ? '‚ñ≤' : '‚ñº' }}</span>
    </th>
    <th (click)="toggleSort('amount')" class="sortable">
      Amount
      <span *ngIf="sortKey === 'amount'">{{ sortAsc ? '‚ñ≤' : '‚ñº' }}</span>
    </th>
    <th (click)="toggleSort('dueDate')" class="sortable">
      Due Date
      <span *ngIf="sortKey === 'dueDate'">{{ sortAsc ? '‚ñ≤' : '‚ñº' }}</span>
    </th>
    <th (click)="toggleSort('status')" class="sortable">
      Status
      <span *ngIf="sortKey === 'status'">{{ sortAsc ? '‚ñ≤' : '‚ñº' }}</span>
    </th>
    <th style="text-align: center;">Actions</th>
  </tr>
</thead>

<tbody>
  <ng-container *ngFor="let invoice of pagedInvoices">
    <!-- üíº Invoice Summary Row -->
    <tr>
      <td>
        <span [ngClass]="{
            'badge-paid': invoice.isPaid,
            'badge-unpaid': !invoice.isPaid
          }">
          {{ invoice.isPaid ? 'Paid' : 'Unpaid' }}
        </span>
      </td>
      <td>{{ invoice.invoiceId }}</td>
      <td>{{ invoice.propertyName }}</td>
      <td>{{ invoice.amount | currency:'USD' }}</td>
      <td>{{ invoice.dueDate | date: 'MMM d, y' }}</td>
      <td>{{ invoice.status }}</td>
  <td>
  <div class="actions-inline">
    <button class="details-btn" (click)="viewInvoiceDetails(invoice)">Details</button>
    <select (change)="processSelectedPayment(invoice, $event)" [disabled]="invoice.isPaid">
      <option value="">Select Payment</option>
      <option value="stripe">Stripe</option>
      <option value="paypal">PayPal</option>
      <option value="plaid">Plaid</option>
          <option value="echeck" disabled>E-Check (coming soon)</option>
        </select>
      </div>

    </td>
    </tr>
</ng-container>
</tbody></table>
  <!-- üîÑ Paging Controls -->
  <div class="pagination-controls">
    <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 0">
      ‚Üê Prev
    </button>
    <span>Page {{ currentPage + 1 }} of {{ totalPages }}</span>
    <button
      (click)="changePage(currentPage + 1)"
      [disabled]="currentPage + 1 >= totalPages"
    >
      Next ‚Üí
    </button>
  </div>
</div>
